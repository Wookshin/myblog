---
title: 15분 안에 ToC를 구현해보자! 
subtitle: Vanilla JS로 Table of Contents 구현하기 
readtime: 15 min
author: wookshin
tags: [javascript]
comments: true
---

<br/>

# 15분 안에 ToC를 구현해보자! 

<br/>

이번에 새로 개편된 MDN 사이트 보셨나요?  
깔끔하고 심플하게 디자인을 만들었는데 보면 볼수록 감탄이 나오더라구요.   
비록 저의 디자인 센스는 꽝이지만, 훌륭한 MDN 사이트의 디자인을 참고하여 ToC를 구현해보고자 합니다.

지금부터 Vanilla JS를 사용해서 ToC(Table of Contents)를 구현하도록 하겠습니다.
실습하듯이 따라하셔도 좋고, 눈으로 슥슥 보셔도 됩니다.
제목은 15분이라 썼지만, 밑에서 설명되는 개념들을 알고 있다는 조건이 있습니다.
헷갈리는 개념들은 설명 링크 넣어놓을게요! 

자! 그럼 시작해볼게요.

<br/><br/>

## 1. 작업 소개

4가지로 작업을 분류하여 진행하고자 합니다.

#### 첫째, 페이지에 있는 h1, h2 태그 엘리먼트를 가져온다.

마크다운을 쓰면 #이 h1 태그 엘리먼트로, ##이 h2 태그 엘리먼트로 변환됩니다. (###은 h3로, ####은 h4로)
제 글의 경우 h1 태그 엘리먼트를 제목으로 h2 태그 엘리먼트를 목차 제목으로 사용하기에, 이 두 태그 엘리먼트를 ToC에 넣을겁니다. 
`documnet.querySelectorAll` 함수 사용할거에요. 

#### 둘째, h1, h2 태그 엘리먼트 안의 내용을 토대로 ToC를 만듭니다.

태그 엘리먼트의 내용은 textContent 속성으로 가져올 수 있습니다.
ToC는 ul 태그와 li 태그로 구성할거에요.
ToC는 스크롤 페이지가 내려가도 사이드쪽에 계속 존재하잖아요.
그거는 sticky position을 통해 구현할겁니다. 

#### 셋째, ToC 내 목차 클릭 시 페이지가 이동되도록 한다.

ToC 내 목차에 click 이벤트를 걸어서 페이지를 이동시킬겁니다.
페이지 이동은 태그 엘리먼트가 가지고 있는 scrollIntoView 함수를 사용할거에요.

#### 마지막, 스크롤에 따라 해당하는 ToC 컨텐츠가 하이라이트되도록 한다.

스크롤이 움직일 때마다 몇번째 목차인지 파악해서 ToC 내 해당 목차를 하이라이트 해줘야는데요.
이거는 IntersectionObserver API를 통해 구현하고자 합니다.
만약 처음 들어보신 API라면 이번 기회에 꼭 익혀보세요.  
스크롤 이벤트와 그 짝궁인 스로틀, 바운싱에서 벗어날 수 있습니다!

<br/><br/>

## 2. 실습 준비

아래 html로 실습을 진행하겠습니다.  
index.html 파일을 하나 만드셔서 하기 내용을 붙여넣으세요.  
그리고 웹브라우저에서 한번 열어보세요!  
<a href="http://wookshin.github.io/examples/toc/example1" target="_blank">예시를 보실려면 여기를 클릭해주세요.</a>

VS Code를 쓰시는 경우 Live Server 확장 프로그램을 활용하시면 편합니다.  
확장 프로그램 설치 후 VS Code에서 index.html 파일을 열어 놓고, Ctrl+Shift+p를 눌러 Live Server를 클릭하면 index.html이 반영된 브라우저가 열립니다.

> https://marketplace.visualstudio.com/items?itemName=ritwickdey.LiveServer

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ToC Example</title>
    <style>
      main {
        display: flex;
      }
      article {
        min-width: 1000px;
      }
      h1 {
        background-color: cadetblue;
      }
      h2 {
        background-color: aquamarine;
      }
      p {
        background-color: beige;
        height: 2000px;
      }
    </style>
  </head>
  <body>
    <main>
      <article>
        <h1>코끼리 위키백과</h1>
        <p>코끼리(elephant, 象)는 장비목에서 유일하게 현존하는 코끼리과를 구성하는 동물들의 총칭이다.</p>

        <h2>1. 어원</h2>
        <p>‘코끼리’는 ‘코가 긴 것, 코가 긴 짐승’이라는 뜻으로 ‘고ㅎ + 길- + -이’의 구성으로 만들어진 것이다.</p>

        <h2>2. 코끼리의 몸</h2>
        <h3>다리</h3>
        <p>몸 표면에는 굵은 털이 전체에 조잡하게 나 있으며, 꼬리 끝에는 줄모양의 긴 털이 나 있다.</p>
        <h3>코</h3>
        <p>코끼리의 코는 가장 활용을 많이하는 수단이다.</p>

        <h2>3. 생태</h2>
        <p>코끼리는 일반적으로 30~40마리씩 무리를 짓고 산다.</p>
        
        <h2>4. 인간과의 관계</h2>
        <p>사람들은 수천 년 전부터 코끼리를 길들여 이용했다.</p>
      </article>
    </main>
  </body>
</html>

```

html에 코끼리에 대한 내용이 들어있습니다.
h1 태그는 코끼리 위키백과란 제목을 나타내고, h2 태그는 각각 큰 목차를 의미합니다.
css쪽을 보시면 main 태그에  display: flex 속성이 부여되어 있습니다.
다음 섹션에서 toc를 만든 다음  main 자손의 article 형제 옆으로 추가할 것인데 정렬을 위해 놓았습니다.

참고로 flex는 정말 유용하게 잘 쓰이니 꼭 한번 익히시길 추천드립니다.
 - https://studiomeal.com/archives/197

이제 실습 준비는 끝났습니다. 
지금부터 처음에 소개한 네 가지 작업을 시작하겠습니다.

<br/><br/>

## 3. 태그 가져오기

브라우저에서 F12를 눌러 개발자 도구를 엽니다.
Console창에 다음과 같이 입력해주세요.

```js
// h1, h2 태그 엘리먼트를 가져와 NodeList에 담아 반환한다.
const tags = document.querySelectorAll('h1, h2')
tags // 출력값 -> NodeList(5) [h1, h2, h2, h2, h2]
```

tags 변수에는 h1, h2 태그가 고스란히 담긴 NodeList가 할당되었습니다.
이를 활용해 ToC에 넣으면 됩니다.

<br/><br/>

## 4. ToC 만들기

하기 html을 `</aticle>` 태그 아래에, css 소스는 style 태그 안에 넣어주세요.  
<a href="http://wookshin.github.io/examples/toc/example2" target="_blank">예시를 보실려면 여기를 클릭해주세요.</a>

```html
<!-- ...</article> -->
<aside>
  <div class="toc">
    <ul>
      h1 들어갈 자리
      <li>h2 들어갈 자리</li>
      <li>h2 들어갈 자리</li>
      <li>h2 들어갈 자리</li>
      <li>h2 들어갈 자리</li>
    </ul>
  </div>
</aside>
```

<br/>

```css
.toc {
  position: sticky;
  top: 100px;
}
```

aside 태그 아래에 toc 클래스명을 가진 div 태그를 생성하고, 그 자손으로 ul, li 태그들을 생성했습니다.  
toc 클래스에 position sticky 속성을 주었습니다.  
한번 마우스 스크롤을 내려보세요. ToC가 잘 따라오죠?

sticky는 자신이 들어가있는 부모 안에서 위치가 결정됩니다.  
`top: 100px`이란 속성은 다음과 같이 동작합니다.  
우선 자신의 부모 태그를 찾는데, 부모 태그는 block 요소(p, div 등)여야 합니다. 
aside는 block 요소이므로 자신의 부모로 지정하여 aside의 맨위(top)에서 100px 아래로 떨어진 곳에 자신의 위치를 잡습니다.  
그리고 스크롤을 내려도 그 위치를 계속 고정하는데 block 요소(p, div 등)를 만나면 그 자리에서 멈춥니다.
즉, sticky는 normal flow(absolute, fixed는 normal flow로 동작하지 않음)로 동작하면서 자신의 부모를 지정하여 그 부모 위치에 상대적으로 자신을 위치시킵니다.  
자세한 내용은 하기 MDN 문서를 참고해주세요.
 - https://developer.mozilla.org/en-US/docs/Web/CSS/position

이제 tags 변수에 있는 내용을 ToC에 넣으면 되겠군요.  
ul, li 태그는 h1, h2 태그에 의해 동적으로 생성할거기 때문에 HTML에서 삭제해주세요.
TOC를 이쁘게 하기 위한 CSS를 추가하겠습니다.
그리고 콘솔 창에 js 코드를 입력해봅니다.
<a href="http://wookshin.github.io/examples/toc/example3" target="_blank">예시를 보실려면 여기를 클릭해주세요.</a>

```html
<!-- ...</article> -->
<aside>
  <div class="toc">
  </div>
</aside>
```

```css
.toc-title {
  padding-left: 10px;
  font-size: 18px;
  font-weight: bold;
  color: cadetblue;
}
.toc-item {
  padding: 5px 10px;
  list-style: none;
  font-size: 15px;
  color: black;
  border-left: 3px solid rgb(171, 171, 171);
}
```

```js
const tags = document.querySelectorAll('h1,h2')
const toc = document.querySelector('.toc')

tags.forEach(tag => {
  if (tag.matches('h1')) {
    const ul = document.createElement('ul')
    ul.classList.add('toc-title')
    ul.textContent = tag.textContent
    toc.appendChild(ul)
  }
  else {
    const li = document.createElement('li')
    li.classList.add('toc-item')
    li.textContent = tag.textContent
    toc.firstElementChild.appendChild(li)
  }
})
```

ToC에 h1,h2 태그 내용이 잘 반영되었나요?  
h1,h2 태그를 담은 tags 리스트를 forEach로 돌려 ToC에 할당 작업을 진행합니다.
tag 변수가 h1 태그일 경우 ul 태그를 생성해서 클래스명과 text 내용을 반영하고 toc에 ul 태그를 자손으로 삽입합니다.
tag 변수가 h1 태그가 아닐 경우(여기에선 h2태그) li 태그를 생성해서 클래스명과 text 내용을 반영하고 toc의 첫 자손(ul 태그)의 자손으로 li 태그를 삽입합니다. 

그럼 두번째 작업은 끝났고, 이제 이벤트 처리를 해보겠습니다.

<br/><br/>

## 5. click 이벤트 추가하기




<br/><br/><br/><br/><br/>
